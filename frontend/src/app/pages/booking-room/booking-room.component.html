<header>
    <app-header-top></app-header-top>
</header>

<div class="my-container">
    <div class="row">
        <div class="col-sm-3 col-12">
            <app-nav-profile></app-nav-profile>
        </div>
        <div class="col-sm-9 col-12">
            <div class="row">
                <div class="col-sm-12">
                    <h1>Đơn đặt phòng</h1>
                </div>
                <div class="col-sm-12">
                    <div class="card" [ngClass]="{ 'd-none': !showDetails }">
                        <div class="card-body">
                            <table class="table table-hover">
                                <thead>
                                    <tr class="text-center">
                                        <th style="width:15%" scope="col">Khách hàng</th>
                                        <th style="width:15%" scope="col">Khách sạn</th>
                                        <th style="width:15%" scope="col">Ngày đặt</th>
                                        <th style="width:15%" scope="col">Ngày trả</th>
                                        <th style="width:15%" scope="col">Trạng thái</th>
                                        <th style="width:15%" scope="col">Thao tác</th>
                                    </tr>
                                </thead>
                                <tbody *ngFor="let item of collection | paginate: { itemsPerPage: _itemsPage, currentPage: _page}">
                                    <tr class="text-center">
                                        <td>{{item.user.fullName}}</td>
                                        <td>{{item.rooms[0].hotel.hotelName}}</td>
                                        <td style="color: rgb(0, 255, 0);">{{item.checkInDate | date:'dd-MM-yyyy'}}</td>
                                        <td style="color: red;">{{item.checkOutDate | date:'dd-MM-yyyy'}}</td>
                                        <td>
                                            <div class="status-locked" *ngIf="item.status=='Đã hủy' || _change">Đã hủy</div>
                                            <div class="status-inactive" *ngIf="item.status=='Đã nhận'">Đã nhận</div>
                                            <div class="status-active" *ngIf="item.status=='Đã đặt'" [ngClass]="{'d-none':_change}">Đã đặt</div>
                                        </td>
                                        <td>
                                            <button (click)="showDeltailsBooking(item.id)" class="btn-edit btn btn-outline-info" matTooltip="Chi tiết" [matTooltipPosition]="'left'"><i class="bi bi-clipboard-check"></i></button>
                                            <button [ngClass]="{'d-none':item.status!='Đã đặt'||_change}" (click)="cancelBookingRoom(item.id)" class="btn-delete btn btn-outline-danger ml-3" matTooltip="Hủy đơn" [matTooltipPosition]="'right'"><i class="bi bi-clipboard-x"></i></button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="card-footer pb-0">
                            <pagination-controls class="text-center" (pageChange)="_page = $event" maxSize="5"></pagination-controls>
                        </div>
                    </div>
                    <div class="card" [ngClass]="{ 'd-none': showDetails }">
                        <div class="card-header p-0 create-city">
                            <div class="row">
                                <div class="col-sm-10">
                                    <h1 class="pl-5 text-info mt-3 mb-3 my-title">Chi tiết đơn đặt phòng</h1>
                                </div>
                                <div class="col-sm-2 create">
                                    <a (click)="hiddenDeltailsBooking()" matTooltip="Đóng" [matTooltipPosition]="'right'" class="btn btn-outline-danger px-3"><i class="fas fa-times"></i></a>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="col-sm-12">
                                        <div class="row mb-3">
                                            <div class="col-sm-3">
                                                <div class="font-weight-bold">
                                                    Thông tin đặt phòng:
                                                </div>
                                            </div>
                                            <div class="col-sm-9">
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <div>Ngày đặt phòng:</div>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <input type="text" value="{{checkInDate}}" class="form-control border-0 bg-white shadow-none" readonly>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-4">
                                                        <div>Ngày trả phòng:</div>
                                                    </div>
                                                    <div class="col-sm-8">
                                                        <input type="text" value="{{checkOutDate}}" class="form-control border-0 bg-white shadow-none" readonly>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="my-setting">
                                        <div>Số lượng phòng: <b>{{totalRoom}}</b></div>
                                    </div>
                                    <div *ngFor="let item of rooms">
                                        <div class="card p-3">
                                            <div class="row">
                                                <div class="col-sm-4">
                                                    <div>
                                                        <img style="height: 9.5rem;" class="img-details elevation-2" src="{{item.image}}" alt="Image">
                                                    </div>
                                                </div>
                                                <div class="col-sm-8">
                                                    <h3>Khách sạn {{item.hotel.hotelName}}</h3>
                                                    <div>Số phòng: {{item.roomNumber}}</div>
                                                    <div>Loại phòng: {{item.roomType.description}}</div>
                                                    <div>Giá phòng: {{item.roomCost | currency:'VND'}} /đêm</div>
                                                    <div>{{item.contents}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div [ngClass]="{ 'show': _success }" class="alert thongbao">
            <mat-icon class="icon-thongbao" style="color: green; font-size: 2.25em;">done</mat-icon>
            <div class="noidung-thongbao">{{_success}}</div>
        </div>
    </div>
</div>