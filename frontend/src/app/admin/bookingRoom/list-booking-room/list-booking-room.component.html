<div class="wrapper">
    <app-navbar></app-navbar>

    <div class="content-wrapper">
        <div class="container-fluid pt-2">
            <div class="card" [ngClass]="{ 'd-none': !showDetails }">
                <div class="card-header p-0 create-city">
                    <div class="row justify-content-center">
                        <div class="col-sm-10">
                            <h1 class="pl-5 text-info mt-3 mb-3 my-title">Danh sách đơn đặt phòng</h1>
                        </div>
                        <div class="col-sm-2 create">
                            <a matTooltip="Thêm mới" [matTooltipPosition]="'left'" [routerLink]="['/admin-page','create-bookingroom']" class="btn btn-outline-success float-right"><i class="fas fa-plus"></i></a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <table class="table table-hover">
                        <thead>
                            <tr class="text-center">
                                <th style="width:15%" scope="col">Email khách hàng</th>
                                <th style="width:15%" scope="col">Khách sạn</th>
                                <th style="width:15%" scope="col">Phòng</th>
                                <th style="width:11%" scope="col">Ngày đặt</th>
                                <th style="width:11%" scope="col">Ngày trả</th>
                                <th style="width:15%" scope="col">Trạng thái</th>
                                <th style="width:20%" scope="col">Thao tác</th>
                            </tr>
                        </thead>
                        <tbody *ngFor="let item of collection | paginate: { itemsPerPage: _itemsPage, currentPage: _page}">
                            <tr class="text-center">
                                <td>{{item.user.username}}</td>
                                <td>{{item.rooms[0].hotel.hotelName}}</td>
                                <td>
                                    <ul *ngFor="let room of item.rooms">
                                        <p> {{room.roomNumber}} </p>
                                    </ul>
                                </td>
                                <td style="color: rgb(0, 255, 0);">{{item.checkInDate | date:'dd-MM-yyyy'}}</td>
                                <td style="color: red;">{{item.checkOutDate | date:'dd-MM-yyyy'}}</td>
                                <td>
                                    <!-- <div class="status-locked" *ngIf="item.status=='Đã hủy'">Đã hủy</div>
                                    <div class="status-inactive" *ngIf="item.status=='Đã nhận'">Đã nhận</div>
                                    <div class="status-active" *ngIf="item.status=='Đã đặt'">Đã đặt</div> -->
                                    <div class="status-locked" *ngIf="item.status=='Đã hủy'">Đã hủy</div>
                                    <div class="status-inactive" *ngIf="item.status=='Đã nhận'">Đã nhận</div>
                                    <div class="status-active" *ngIf="item.status=='Đã đặt'">Đã đặt</div>
                                </td>
                                <td>
                                    <button (click)="showDeltailsBooking(item.id)" href="#" class="btn-edit btn btn-outline-info" matTooltip="Chi tiết" [matTooltipPosition]="'left'"><i class="fas fa-calendar-check"></i></button>
                                    <a [routerLink]="['/admin-page','list-bookingroom']" (click)="deleteBookingRoom(item.id)" class="btn-delete btn btn-outline-danger ml-3" matTooltip="Xóa" [matTooltipPosition]="'right'"><i class="fas fa-trash"></i></a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="card-footer pb-0">
                    <pagination-controls class="text-center" (pageChange)="_page = $event" maxSize="5"></pagination-controls>
                </div>
            </div>

            <div class="card" [ngClass]="{ 'd-none': showDetails }">
                <div class="card-header p-0 create-city">
                    <div class="row">
                        <div class="col-sm-10">
                            <h1 class="pl-5 text-info mt-3 mb-3 my-title">Chi tiết đơn đặt phòng</h1>
                        </div>
                        <div class="col-sm-2 create">
                            <a (click)="hiddenDeltailsBooking()" matTooltip="Đóng" [matTooltipPosition]="'right'" class="btn btn-outline-danger px-3"><i class="fas fa-times"></i></a>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-3">
                                    <div class="my-setting font-weight-bold">
                                        Thông tin khách hàng:
                                    </div>
                                </div>
                                <div class="col-sm-9">
                                    <div class="">
                                        <div class="row">
                                            <div class="col-md-3 col-xl-2">
                                                <div class="my-setting">
                                                    <div>Họ và tên</div>
                                                </div>
                                            </div>
                                            <div class="col-sm-10">
                                                <div class="my-setting">
                                                    <div>{{fullName}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="">
                                        <div class="row">
                                            <div class="col-md-3 col-xl-2">
                                                <div class="my-setting">
                                                    <div>Địa chỉ email</div>
                                                </div>
                                            </div>
                                            <div class="col-sm-10">
                                                <div class="my-setting">
                                                    <div>{{email}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="">
                                        <div class="row">
                                            <div class="col-md-3 col-xl-2">
                                                <div class="my-setting">
                                                    <div>Ngày sinh</div>
                                                </div>
                                            </div>
                                            <div class="col-sm-10">
                                                <div class="my-setting">
                                                    <div>{{dateOfBirth}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="">
                                        <div class="row">
                                            <div class="col-md-3 col-xl-2">
                                                <div class="my-setting">
                                                    <div>Số điện thoại</div>
                                                </div>
                                            </div>
                                            <div class="col-sm-10">
                                                <div class="my-setting">
                                                    <div>{{phoneNumber}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="">
                                        <div class="row">
                                            <div class="col-md-3 col-xl-2">
                                                <div class="my-setting">
                                                    <div>Giới tính</div>
                                                </div>
                                            </div>
                                            <div class="col-sm-10">
                                                <div class="my-setting">
                                                    <div>{{gender=='nu'?"Nữ":"Nam"}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr class="w-100">
                        <div class="col-sm-12">
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <div class="my-setting font-weight-bold">
                                        Thông tin đặt phòng:
                                    </div>
                                </div>
                                <div class="col-sm-9">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <div>Ngày đặt phòng:</div>
                                            </div>
                                        </div>
                                        <div class="col-sm-9">
                                            <div class="my-setting">
                                                <div>{{checkInDate}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <div>Ngày trả phòng:</div>
                                            </div>
                                        </div>
                                        <div class="col-sm-9">
                                            <div class="my-setting">
                                                <div>{{checkOutDate}}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="my-setting">
                                <div>Số lượng phòng: <b>{{totalRoom}}</b></div>
                            </div>
                            <div *ngFor="let item of rooms">
                                <div class="card p-3">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <div>
                                                <img class="img-details elevation-2" src="{{item.image}}" alt="Image">
                                            </div>
                                        </div>
                                        <div class="col-sm-8">
                                            <h3>Khách sạn {{item.hotel.hotelName}}</h3>
                                            <div>Số phòng: {{item.roomNumber}}</div>
                                            <div>Loại phòng: {{item.roomType.description}}</div>
                                            <div>Giá phòng: {{item.roomCost | currency:'VND'}} /đêm</div>
                                            <div>{{item.contents}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <hr class="w-100">
                        <div class="col-sm-12">
                            <div class="row mb-3">
                                <div class="col-sm-3">
                                    <div class="my-setting font-weight-bold">
                                        Xử lý đơn:
                                    </div>
                                </div>
                                <div class="col-sm-9">
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <div>Người xử lý:</div>
                                            </div>
                                        </div>
                                        <div class="col-sm-9">
                                            <div class="my-setting">
                                                <div>{{checkOutDate}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <div>Ngày xử lý:</div>
                                            </div>
                                        </div>
                                        <div class="col-sm-9">
                                            <div class="my-setting">
                                                <div>{{checkInDate}}</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <div>Trạng thái</div>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <div style="text-align: center; margin: -8px 0px 0px -25px;" class="status-locked" *ngIf="status=='Đã hủy'">Đã hủy</div>
                                                <div style="text-align: center; margin: -8px 0px 0px -25px;" class="status-inactive" *ngIf="status=='Đã nhận'">Đã nhận</div>
                                                <div style="text-align: center; margin: -8px 0px 0px -25px;" class="status-active" *ngIf="status=='Đã đặt'">Đã đặt</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" *ngIf="status=='Đã đặt'">
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <div>Xử lý:</div>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="my-setting">
                                                <button (click)="confim(_id)" style="width: 85%;;text-align: center; margin: -8px 0px 0px -25px;" class="btn btn-block btn-info">Xác nhận</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div [ngClass]="{ 'show': _success }" class="alert thongbao">
                <mat-icon class="icon-thongbao" style="color: green; font-size: 2.25em;">done</mat-icon>
                <div class="noidung-thongbao">{{_success}}</div>
            </div>
        </div>
    </div>

    <app-footer-admin></app-footer-admin>
</div>